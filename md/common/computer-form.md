## 计算机基础（主要来于书籍《计算机组成与体系结构：性能设计》）

### 导论
1. 计算机组成与体系结构
   1. 计算机体系结构是那些对程序员可见的系统属性，直接影响到程序的逻辑执行，包含指令集、各种数据类型的比特数、输入输出机制、内存寻址等
   2. 计算机组成是实现结构规范的操作单元及其相互连接，包括对程序员可见的应用细节
   3. 体系结构是规范，组成是细节实现。同一个体系结构的实现不同，性能和价格可能天差地别
   4. 通常来说，越小的机器，新旧机器的兼容性要求越少，组成与体系结构设计决策的关系就越紧密
2. 结构和功能
   1. 结构：部件相关联的方法
      1. 中央处理单元CPU：他控制计算机的操作并执行数据处理功能
         1. 控制单元CU：控制CPU以至于整个计算器的操作
         2. 算术逻辑单元ALU：执行计算机的数据处理功能
         3. 寄存器：提供CPU的内部存储
         4. CPU系统互联：提供控制器、ALU和寄存器之间的某种通信机制
      2. 主存储器：存储数据
      3. I/O：在计算器及其外部环境之间传输数据
      4. 系统互联：为CPU、主存储器和I/O之间提供一些通信机制。最常见的列子是系统总线
   2. 功能：作为结构组成部分的单个独立部件的操作。概括为：数据处理、数据存储、数据传送、控制（通用为主，专用功能由编程完成）


### 计算机的演变和性能
1. 计算机简史
   1. 第一代：真空管，由导线、金属片、玻璃外壳和真空管构成
      1. ENIAC：第二次世界大战时，美军的弹道研究实验室在提供数据表的精确性和及时性遇到困难
         1. 1943年启动，1946年建成。计算器重40吨、占地1500平方英尺、共1.8w+真空管，功率达140kW，每秒可执行5000次加法，于1995年拆除
         2. 十进制机器。存储器包含20个累加器，每个都能保存一个10位十进制数，每一位数由10个真空管环标识。任何时候，仅有一个真空管处于ON状态，标识10个数字重的一个
         3. 必须手动编程，一切都要通过设置开关和插拔电缆头来实现
         4. 它的第一个任务是完成一系列复杂的运算，以帮助判断氢弹的可行性
      2. 冯.诺依曼机
         1. 1946年启动（被称为IAS计算机），至1952年仍未完成，却成为了通用计算机的原型
         2. IAS计算机包含1000个存储单元，它们被称为字，每个字有40bit。指令和数据都存储在此，数据被表示为二进制形式，指令是二进制编码![IAS存储](../img/comp/history-IAS-storage.png)
         3. 控制器通过一次从存储器取一条指令并执行它的方式来操作IAS，![IAS详细扩展图](../img/comp/history-IAS-storage.png)
         4. IAS反复执行指令周期来运行，每个指令周期由2个字周期组成
            1. 在取指周期中，下一条指令的操作码装入IR，地址部分装入MAR。指令从IBR或存储器获取，即先从存储器装载一个字到MBR，然后将该字解开放入IBR、IR和MAR。为什么不直接获取？因为这些操作都是由电子电路控制并且导致数据路径的使用，为了简化电路，只有一个寄存器来指定存储器读写的地址，而且也只有一个寄存器来存放数据源或目标
            2. 一旦操作码存入IR，则进入执行周期。控制电路翻译操作码，并通过发送相应的控制信号来执行指令，这些信号控制数据的发送和ALU操作的执行。![IAS部分流程图](../img/comp/history-IAS-flow-chart-partion.png)
            3. IAS一共21条指令，可分为5类
               1. 数据传送：在存储器和ALU的寄存器之间或在两个ALU寄存器之间传送数据
               2. 无条件转移：通常，控制器按照顺序执行存储器的指令，但这个顺序能通过跳转指令加以改变，以便执行重复的操作
               3. 条件转移：可以依据条件来决定是否跳转，从而选择从何处跳转
               4. 算术运算：由ALU完成的操作
               5. 地址修改：允许在ALU中计算地址，并将它插入存储器的指令中，为程序寻址带来很大的灵活性
               6. ![IAS指令](../img/comp/history-IAS-instruction-set.png)
      3. 商用计算机：Sperry、IBM
   2. 第二代：晶体管。单个独立封装的晶体管(晶体管、电阻、导线)称为分立元件，分立元件独立制造，封装在自己的容器中，然后一起焊接到或连接到纤维板上，最后安装到电子设备中。整个制造过程昂贵且麻烦
      1. IBM 7049是二代计算机的代表，它有两个特点
         1. CPU通过给数据通道（数据通道指独立的IO模块，具有自己的处理器和指令集）发送一个控制信号来初始化IO传送，数据通道独立的执行它的任务，并在操作完成后通知CPU
         2. 多路复用：他是数据通道、CPU、内存的中心连接点。多路器调度CPU和数据通道对内存的访问，允许这些设备独立运行
         3. ![IBM 7049配置](../img/comp/history-IBM-II-performance.png)
   3. 集成电路
      1. 微电子技术
         1. 存储器位元是一个能够存储一位数据的元件，任意时刻都处于两个稳定状态之一。将大量的基本元件连接起来，就能建造一台计算机。
            1. 数据存储：由存储器位元提供
            2. 数据处理：由逻辑门电路提供
            3. 数据移动：部件间的通路用于将数据从内存传送到内存，或从内存通过门电路再传送给内存
            4. 控制：部件间的通路传输控制信号
         2. 晶体管、电阻、导线都可以用硅之类的半导体制成，将整个电路安装在很小的硅片上而不是用分立元件搭成的等价电路，一块硅晶片上能同时制造很多个晶体管，通过金属化过程相互连接，以形成电路
         3. 一块薄硅晶片话费由多个小区域排列而成的阵列，每个区域有几平方毫米，他们上面都有相同的电路。这块镜片被划分成许多块芯片，每块芯片都包括许多逻辑门或存书单元，以及许多输入输出连接点，然后封装这块芯片，使之得到保护，并加上引脚，用以连接芯片外部的其他设备。许多这样的集成电路块可以连接在印刷电路板上，产生更大、更复杂的电路
         4. ![晶片、芯片和逻辑门的关系&晶体管数量增长图](../img/comp/history-IBM-II-performance.png)
         5. 上图描述了集成电路的关键概念，和密度的增长。起初，只有几个门和存储单元可以可靠的制造并封装在一起，被称为小规模集成电路SSI，后期几乎直线增长，Intel合伙创办人高登.摩尔提出摩尔定律：
            1. 在芯片集成度快速增长的期间，单个芯片的成本几乎没有变化，这意味着计算机逻辑电路和存储器电路的成本显著下降
            2. 因为在集成度更高的芯片中逻辑和存储器单元的位置更靠近，电子线路长度更短，所以提高了工作速度
            3. 计算机变得更小，更容易放置在各种坏境中
            4. 见笑了电能消耗和对冷却的要求
            5. 集成电路内部的连接比焊接更可靠
      2. IBM System/360（大型机）
         1. 与占据了市场的IBM 7000并不兼容，但360系列机相互兼容，取得了巨大的成功，360体系结构至今仍是IBM大型机的体系结构。系列机具有以下特征：
            1. 相同或相似的指令集
            2. 相似或相同的操作系统
            3. 更高的速度
            4. 更多的IO端口数
            5. 更大的内存容量
            6. 更高的成本
            7. 这不就是所谓的刀法精准吗？低端机砍掉一些配置...
      3. DEC公司的PDP-8（小型机，总线结构）
      4. 后续几代
         1. 集成电路规模
            1. 大规模集成电路LSI：一块集成电路芯片可放置1000个元件
            2. 超大规模集成VLSI：每个芯片10000个元件
            3. 巨大规模ULSI：超过1000000元件
         2. 存储器
            1. 20世纪50-60年代
               1. 存储器使用微笑的铁磁体环做成，直径越1/16英寸，这些小环掉在计算机内用细线做成的网格上
               2. 一个环（磁芯）的一种磁化方向代表1，另一个磁化方向则代表0
               3. 磁芯存储器速度相当快，读取1位只需百万分之一秒，但是价格贵、体加大，读出是破坏性的，会查处其存储的数据
            2. 1970年
               1. 仙童公司生产了第一个容量较大的半导体存储器，一块相当于单个磁芯大小的芯片，包含256位内存
               2. 半导体存储器读取1位只需70ns，而且是非破坏性的，但是每位的价格比磁芯更昂贵
            3. 1974年
               1. 半导体存储器每位的价格比磁芯更便宜，而且往后价格快速下跌，但物理存储密度不断增加。1K-4K-16K...16GB
         3. 微处理器
            1. 1971年，Intel开发了Intel 4004（4位），将一个CPU的所有原件都放在同一块芯片，微处理器诞生。
            2. 1972年，Intel开发了Intel 8008（8位）
            3. 1974年，Intel开发了Intel 8080（8位），是第一个通用微处理器
            4. 70年代末，出现通用16位微处理器
            5. 1981年，贝尔实验室和HP公司开发出32位单片微处理器。1985年，Intel退出32位微处理器Intel 80386
            6. ![Intel CPU发展](../img/comp/history-Intel-cpu.png)
   4. ![计算机发展阶段](../img/comp/history-computer-stages.png)
2. 性能设计
   1. 微处理器包含的技术
      1. 转移预测：处理器提前考察取自内存的指令代码，并预测哪条分支指令或哪组指令可能下一步会被执行，并将它们放入缓存，这样处理器就会一直处于繁忙之中
      2. 数据流分析：处理器通过分析那一条指令依赖其他指令的结果或数据，来优化指令调度。事实上，准备好的指令就可以被调度执行，不必按照原来的顺序，减少不必要的时延
      3. 推测执行：使用转移预测和数据流分析，一些处理器让指令在程序实际执行之前就推测执行，并将结果存储在临时空间。通过执行可能需要的指令，可以让处理器的执行机制尽可能的保持繁忙
   2. 性能平衡
      1. 起因：处理器的性能飞速发展，计算器其他关键部件并没有跟上。需调整组成和结构，以补偿各种部件之间的能力不匹配
   3. 芯片组成和体系结构的改进
      1. 处理器提速方法
         1. 提高处理器硬件速度
         2. 提高插入在处理器和主存之间的cache容量和速度
         3. 改变处理器的组成和体系结构以提高指令执行的有效速度
      2. 处理器提速阻碍
         1. 功耗：芯片上逻辑米和和时钟速度的提升，芯片消耗的功率密度随之提高，需解决散热问题
         2. RC延迟：电子在芯片上各晶体管间流动的速度受限于连接它们的金属线的电阻和电容。特别是，延迟随RC之积增长而增长。由于芯片上元件尺寸变小，互联线更细，从而电阻增加了；同时，线排列更紧密，电容也增大了
         3. 存储器滞后：存储器速度落后于处理器速度
      3. 演化策略
         1. 增加cache容量
         2. 处理器内指令执行逻辑越来越复杂，以允许处理器内指令并行执行
         3. 多核处理器
3. Intel x86体系结构的进展
4. 嵌入式系统和ARM
   1. 嵌入式系统：是计算机硬件、软件和可能附加的机械或其他部分的一种组合，用于执行特定的功能。在许多情况下，嵌入式系统是大型产品和系统的组成部分，例如轿车的刹车系统。它具有各种变化的需求和限制
      1. 从小到大的系统，意味着完全不同的成本限制，对优化和再利用有不同的需求
      2. 不严格的到非常严格的需求和不同质量要求的组合
      3. 从短到长的生命周期
      4. 不同的环境条件
      5. 不同的应用特征导致静态负载对动态负载、慢速对快速、计算密集型任务对交互密集型任务以及他们的组合
      6. 不同的计算模型，从离散事件系统到包含连续时间动态的系统
      7. ![嵌入式系统的可能组成](../img/comp/history-embedded-system-sample.png)
   2. ARM：是一种由英国剑桥ARM公司设计的基于RISC的微处理器和微控制器序列
5. 性能评价
   1. 时钟速度和每秒指令数
      1. 系统时钟
         1. 产生：一般情况下，时钟信号由水晶振子产生，水晶振子在由动力供应时能产生一个连续的信号波。该波被转化为一个数字电压脉冲流，连续的供应给处理器电路。例如，1个1GHz的处理器每秒接受10亿个脉冲
         2. 速率定义：脉冲的速率被称为时钟频率，或时钟速度。2个脉冲之间的时间定义为周期时间。每增加一个脉冲或时钟被称为一个周期，或时钟滴答声。
         3. 时钟和处理器：时钟频率必须适应处理器的物理层。处理器的操作需要信号将其从处理器的一个元件传送到另一个元件。当信号被放在处理器内部的一根线上时，他将占用一些有限的时间量使电压水平平静下来，以便一个正确的值(0或者1)可用。这取决于处理器的物理层，有些信号可能比其他信号变化更快。因此，操作必须同步，以便适当的电信号值可为每个操作用到
         4. 其他说明：指令的指令包含很多歌离散的步骤，如取指、译码指令的各个部分、取和存数据以及执行算术和逻辑运算。有的指令只需几个周期，另一些需要几十个周期。当使用流水线时，多条指令同时被执行。因此，不同处理器的时钟速度不能代表性能
      2. 指令执行速度
         1. 通用度量1：每秒百万条指令（MIPS）
         2. 通用度量2：每秒百万条浮点操作（MFLOPS，通常用于科学计算和游戏应用）
   2. 基准程序：上述度量方式并不适用所有场景，另一种方式是写一组基准程序，在不同机器上运行，对执行时间做比较。
      1. 基准程序所需具备的一些特征（WEIC90定义）如下：
         1. 由高级语言编写，可以方便的应用于不同的机器
         2. 是各种特殊程序设计方式的代表
         3. 易于度量
         4. 由广泛的发行
      2. SPEC标准程序
   3. 阿姆达尔定律：运行在多核计算机上的软件必须适应高速并行执行环境，以利用并行处理的能力


### 计算机功能和互连的顶层视图
1. 计算机的部件
   1. 硬布线程序：如果要执行一种特定计算，需要构造一个专门用于特殊计算的逻辑单元的配置。将各种元件连接成所需配置的过程，可以看成是某种形式的编程。得到的"程序"以硬件方式存在，被称为硬布线程序
   2. 软件：构造一个具有算术和逻辑功能的通用结构。这组经验根据提供给他的控制信号，对数据执行各种功能。硬件的一部分翻译每条指令并且产生相应的控制信号。另外，还需要输入模块、存储指令和数据的模块，视图如下
      1. ![计算机部件：顶层视图](../img/comp/structure-computer-view.png)
   3. ![硬件和软件的方法](../img/comp/structure-hard-soft.png)
2. 计算机的功能
   1. 指令读取与执行
      1. 计算机完成的基本功能是执行程序，程序是由存储在存储器的一串指令组成。指令的处理有2个步骤：读取指令，执行指令。一条指令所要求的处理过程被称为![指令周期](../img/comp/structure-instruction-cycle.png)
      2. 某个指令的执行周期可能包含存储器的多次访问，或IO操作。在新的状态途中，对于任意给定指令周期，有些状态可能为空，有的状态可能出现多次。状态描述如下
         1. 指令地址计算iac：决定下一条将要执行的指令的地址，通常是前一条指令的地址加一个固定值
         2. 读取指令if：将指令从存储器单元读到处理器中
         3. 指令操作译码iod：分析指令，以决定将执行何种操作以及将使用的操作数
         4. 操作数地址计算oac：如果该操作包含对存储器或通过IO的操作数访问，那么决定操作数的地址
         5. 取操作数of：从存储器或IO读取操作数
         6. 数据操作do：完成指令需要的操作
         7. 存储操作数os：将结果写入存储器或者输出到IO
         8. ![指令周期状态图](../img/comp/structure-instruction-cycle-states.png)
         9. ![指令周期状态图 中断](../img/comp/structure-instruction-cycle-states-interrupt.png)
      3. 程序执行示例
         1. 程序：将存储器地址940与地址941的内容相加，结果放到地址941；处理器包含唯一的数据寄存器，被称为累加器AC；指令和数据都是16位长;![示例假想机特性](../img/comp/structure-hard-soft.png)
         2. 初始时，PC=300，取出第一条指令（16进制值为1940）装入IR，PC++（注意，此处忽略了MAR和MBR的使用）
         3. IR前4位（操作码，为16进制1）指出要装入累加器，剩余12位（地址码16进制940）指定从地址940装载数据。结果：将地址940的数据0003装入AC
         4. 从301取出下一条指令5941，PC++
         5. AC存放的内容和941单元的内容相加，结果放入AC
         6. 从302取出下一条指令2941，PC++
         7. 将AC内容存入941
         8. ![示例执行图例](../img/comp/structure-mock-instruction-execute.png)
   2. 中断
      1. 描述：几乎所有的计算机都提供一种机制，其他模块如IO、存储器通过此机制可以中断处理器的正常处理。处理器挂起当前程序的操作，跳转服务于中断处理程序来相应，并且在设备服务完后恢复原来的执行
      2. 类型和产生的原因：![中断分类](../img/comp/structure-interrupt-type-reasons.png)
      3. 目的：提高处理器的效率，无需同步等待慢处理结果
      4. 多重中断的处理办法
         1. 禁止中断：处理器在处理中断时，可以忽略其他中断信号；这种处理方式没有考虑相对的优先级和时间紧迫的需要，可能会导致数据丢失
         2. 定义中断的优先级，且允许优先级高的中断引起低级中断处理程序本身本中断
   3. IO功能
3. 互连结构：计算器包含一组部件或3中基本类型的模块（处理器、存储器、IO），模块之间相互通信，因此必须有连接这些模块的通路
4. 总线互联
   1. 定义：总线是连接两个或多个设备的通信通路。总线的关键特征是共享传输介质（多个会混淆，同时只能有一个传输）。总线通常由多条通信路径或线路组成，每条线能传送代表1或0的信号
   2. 总线结构
      1. 分类
         1. 数据线：提供系统模块间传输数据的路径，组合在一起称为数据总线。一般包含32、64、128或更多的分离导线，线的数目称为宽度。因为每条线每次能传输1位。宽度是决定系统总体性能的关键因素
         2. 地址线：用于指定数据总线上数据的来源或去向。如果处理器从存储器读取一个字，则将字的地址放到地址线上。地址总线的宽度决定了系统能使用的最大的存储器容量。地址线也用于IO端口的寻址。地址线的高位用于选择总线上指定的模块，低位用于选择模块内具体的存储器单元或IO端口
         3. 控制线：用来控制对数据线和地址线的存取和使用。控制信号在系统模块之间发送命令和时序信号，时序信号指定了数据和地址信号的有效性，命令信号指定了要执行的操作。典型的控制信号如下：
            1. 存储器写：引起总线上的数据写入被寻址的单元
            2. 存储器读：使所寻址单元的数据放到总线上
            3. IO写：引起总线上的数据输出到被寻址的IO端口
            4. IO读：使被寻址的IO端口的数据放到总线上
            5. 传输响应：表示数据已经从总线上接受，或者数据已放到总线上
            6. 总线请求：表示模块需要获得对总线的控制
            7. 总线允许：表示发出请求的模块已经被允许控制总线
            8. 中断请求：表示某个中断正在悬而未决
            9. 中断响应：未决的中断请求被响应
            10. 时钟：用于同步操作
            11. 复位：初始化所有模块
         4. 为连接的模块提供电源的电源馈线
         5. 其他描述
            1. 如果一个模块希望向另一个模块发送数据，必须做2件事：获取的总线的使用权；通过总线传送数据
            2. 如果一个模块希望向另一个模块请求数据，必须做2件事：获取的总线的使用权；通过适当的地址线和控制线向另一模块发送请求，然后必须等待另一模块发送数据
            3. 从物理上来说，总线是多条平行的电导线，这些导线是卡或板上刻出来的金属线。总线延伸到所有系统部件，每一个系统部件都连接到总线的全部或部分线
      2. 多总线层次结构
         1. 单总线性能瓶颈
            1. 设备越多，总线长度越大，传输延迟越大
            2. 聚集的传输请求接近总线容量时，总线会成为瓶颈
         2. ![总线实例](../img/comp/structure-bus-instance.png)
      3. 总线的设计要素
         1. 总线类型
            1. 物理专用：使用多条总线，每条与模块的一个子集相连接。优点是总线冲突减少，吞吐量高；缺点是增加了系统的成本和规模
            2. 分时复用：根据控制信号实现不同的功能。优点是布线少，节省成本和空间；缺点是每个模块需要更复杂的控制电路，可能导致性能降低
         2. 总线的仲裁方法：集中式总线控制器；每个模块包含访问控制逻辑，这些模块共同作用，分享总线。
         3. 时序
            1. 同步时序：总线上事件的发生由时钟决定。总线包含时钟信号线，他传送相同长度的、由0\1交替的规则信号的时钟序列。一次1~0传送称为时钟周期或总线周期。它定了一个时间槽，总线上其他所有设备都能读取时间线，而且所有事件都在时钟周期的开始时发生。示例如下
               1. 第一个时钟周期，初期将将存储器地址放到地址总线，并且可以声明各种状态线。一旦地址线上的信号稳定，处理器就会发出一个地址允许信号
               2. 对于读操作，处理器在第2个时钟周期开始时发出一个读命令。存储器模块识别地址，延迟一个周期后，将数据放到数据线上，处理器从数据线读取数据，并且撤销读信号
               3. 对于写操作，处理器在第2个周期开始时将数据放到数据线上，并且在数据线稳定后发出一个写命令。存储器模块在第3个时钟周期从数据线上复制信息
               4. ![同步时序时序图](../img/comp/structure-bus-design-sync.png)
            2. 异步时序：总线上一个事件的发生取决于前一个事件的发生
               1. 对于读操作
                  1. 处理器发送地址信号和状态信号到总线上，待这些信号稳定后，它发出读命令，指示有效地址和控制信号的存在。
                  2. 相应存储器译码地址并将数据放到数据线上。等到数据线上的信号稳定，则存储器模块确认信号有效，以便通知处理器数据可用
                  3. 一旦处理器从数据线上读取数据后，它立即撤除读信号，这会引起存储器模块撤除数据和确认信号
                  4. 一旦确认信号撤除，处理器则删除地址信息
               2. 对于写操作：总线的主控者将数据放到数据线上，与此同时启动状态线和地址线。存储器模块通过从数据线上复制数据来响应写命令，并使确认线上的信号有效。然后主控者撤除写命令信号，而存储器撤除确认信号 
               3. ![异步时序时序图](../img/comp/structure-bus-design-async.png)
            3. 总线宽度
            4. 数据传输类型
               1. 总线在等待获取获取控制权时，会有一定的延迟。部分设计允许一些"原子操作"，如"读-修改-写"，"写后读"，"块
               2. ![数据传输类型](../img/comp/structure-bus-design-type.png)
5. 外设部件互联PCI
   1. 简介
      1. 定义：是一种高带宽、独立于处理器的总线，它能够作为中间层或外围设备总线。它是转慢为满足现代系统IO要求而设计的较经济的总线，实现它只需要很少的芯片，而且它支持将其他总线连接到PCI上
      2. 来源：Intel在1990年为Pentium系统开发PCI，结果被广泛的采纳
      3. 单处理器PCI：DRAM控制器与到PCI总线的桥接器相结合，提供了与处理器更紧密的耦合，同时提供高速传输数据的能力
      4. 多处理器PCI：一个或多个PCI总线通过桥接器连接到处理器所在的系统总线上。系统总线只支持处理器/高速缓存单元、主存储器及PCI桥接器。桥接器的使用保证了PCI独立于处理器，同时又提供快速传送或者接收数据的能力
      5. ![典型的PCI结构](../img/comp/structure-bus-PCI-sample.png)
   2. 总线结构：PCI可配置成32位或64位。
      1. 49线PCI功能分组如下：
         1. 系统引脚：包括时钟和复位引脚
         2. 地址和数据引脚：包括32根分时复用的地址线和数据线
         3. 接口控制引脚：控制数据交换的时序，并提供发送端和接收端的协调
         4. 仲裁引脚：不同于其他PCI信号线，它们是不共享的线，每个PCI主控制器有自己的一对仲裁线，他们直接连到PCI总线仲裁器上
         5. 错误报告引脚：用于报告奇偶校验位及其他的错误
         6. ![必备的PCI信号线](../img/comp/structure-bus-PCI-line-necessary.png)
      2. 51个可选信号线（上述49线是必须包含的）
         1. 中断引脚：他们提供必须请求服务的PCI设备。它们是不共享的，每个PCI设备有自己的中断线或连接到中断控制器的线
         2. 高速缓存支持引脚：用来支持在处理器或其他设备中能被高速缓存的PCI上的存储器
         3. 64位总线扩展引脚：包含32根分时复用的地址线和数据线。他们与必有的地址/数据线一起，形成64位的地址/数据总线。这一组线的其余线用于解释改传送地址和数据的信号并是指有效。最后，还有使两个PCI设备具备64位能力的两根线
         4. JTAG/边界扫描引脚：这些信号线支持IEEE标准1149.1中定义的测试程序
         5. ![可选的PCI信号线](../img/comp/structure-bus-PCI-line-optional.png)
   3. PCI命令
      1. 中断响应：是一条读命令，使设备作为PCI总线上的中断控制器
      2. 特殊周期：由发送端向一个或多个目标广播消息
      3. IO读、IO写、存储器读、存储器写、存储器读航、存储器读多行、存储器写和无效、配置读、配置写、双地址周期（由发送端来指示它使用64位寻址）
   4. 数据传送![PCI读时序图](../img/comp/structure-bus-PCI-read-data-transfer.png)
   5. 仲裁
      1. PCI使用集中式的同步仲裁方法，竹工坊有独立的请求REQ信号和允许GNT信号。这些信号线连接到中央控制器上，使用"请求-允许"的握手联络方式来访问总线
      2. PCI规范没有指定仲裁算法，可以由设计方指定，如FIFO、轮转。


### 存储器（内部存储器）
1. 概述
   1. 存储系统的特性
      1. 存储位置：指存储器处于计算机的内部或外部。内部存储器通常指主存，还有一些其他形式，如处理器的局部存储器（寄存器）。外部存储器由外围存储设备组成，处理器通过IO控制器去访问它们。
      2. 存储容量：内部存储器通常用字节或字（8、16、或32位）来表示。外部存储器的存储容量通常也用字节来表示
      3. 传输单元：对于内部存储器，传输单元等同于输入和输出到存储器模块的数据线数，它等于字长，但通常更大，如64、128或256位。
      4. 存储方法：
         1. 顺序存取：存储器组织称许多称为记录的数据单元，它们以特定的线性序列方式存取。存储的地址信息用于分割记录和帮助索引。采用共享读-写结构，经过一个个的中间记录，从当前的存储位置移动到所要求的位置。因此，存取不同记录的时间相差很大。如磁带机
         2. 直接存取：也采用共享读-写结构。但是单个块或记录有基于物理存储位置的唯一地址。通过采用直接存取到达所需的块处，然后在块中顺序搜索、计数或等待，直到目的地址。同样，存取记录的时间相差很大。如磁盘机系统
         3. 随机存取：存储器每个可寻址的存储位置有唯一的物理编排的寻址地址。存取给定存储位置的时间是固定的。因此，任何存储位置可以随机选取、直接寻址和存取。如主存、某些高速缓存系统
         4. 关联存取：是随机存取类的存储器，它允许对一个字中的某些指定位进行检查比较，是否与特定样式匹配。因此，字是通过它的内容而不是地址进行检索。与随机存取相同，每个存储位置有自己的寻址机制，并且检索时间是固定的，不依赖于存储位置或前面的存取方式。如高速缓存
      5. 存取时间（延迟）：对于随机存取，是一次读或者写的时间；即从地址传送给存储器的时刻到数据被存储或使用花费的时间；非随机存取，是把读-写结构定位到所需要的存取位置所花费的时间
      6. 存储周期时间：主要用于随机存取，它是存取时间加上下一次存取开始之前所需要的附加时间。福建时间指用于瞬变的信号消失或数据破坏性读后的再生。存储周期时间与系统总线相关，而不是与处理器相关
      7. 传输率：数据传入或传出存储单元的速率。对于随机存取，t=1/周期时间；非随机存取t=avg+n/r，a为平均存取时间，n为位数，r为传输率
      8. ![存储器特性](../img/comp/cache-properties.png)
      9. 其他概念
         1. 字：存储器的自然单元。字长通常与一个整数的数据位数和指令长度相等。
         2. 可寻址单元：地址位长度A和可寻址的单元数N之间的关系是2^A=N
         3. 传输单元：对于主存储器，这是指每次读出或写入存储器的位数。传输单元不必等于一个字或一个可寻址单元。对于外部存储器，数据的传送经常是比一个字大得多的单元来传送，即是所谓的块
         4. 物理类型：半导体存储器（易失、非易失）、用于磁盘和磁带的磁表面存储器（非易失）、光学和磁-光存储器
         5. 易失性存储器：电源开关断开时，信息自动衰减或丢失；非易失性存储器会一直保存
         6. 不可擦除存储器：不能修改，除非破坏存储单元。这种类型的半导体存储器被称为只读存储器ROM
   2. 存储器层次结构
      1. 存在的限制
         1. 存取时间越短，平均每位的花费就越大
         2. 存储容量越大，平均每位的花费就越小
         3. 存储容量越大，存取时间就越长


### 简称或概念
1. 算术逻辑单元：arithmetic and login unit，ALU
2. 控制单元：control unit
3. 中央处理单元：control processing unit，CPU
4. 电子数字积分器和计算器：Electronic Numerical Integrator And Computer，ENIAC
5. 电子离散变量自动计算机：Electronic Discrete Variable Computer，EDVAC。冯.诺依曼在这个计划公布了将程序以某种程序和数据一同存于存储器中，计算器通过存储器读取程序来获取指令，而且通过设置一部分存储器的值就可以编写和修改程序的思想
6. 随机存取存储器:Random Access Memory,RAM
7. 指令寄存器IR：包含正在执行的8位操作码指令
8. 指令缓冲寄存器IBR：用来暂存来自存储器一个字的右边指令
9. 程序计数器PC：存放将要从存储器中获取的下一对指令的地址
10. 存储器地址寄存器MAR：指定将要从MBR写进存储器或从存储器读入MBR的存储器字单元的地址
11. 存储器缓冲寄存器MBR：包含将要写到存储器或IO单元，或者接收来自存储器或IO单元的一个字
12. 累加器AC和乘商寄存器MQ：用来暂存ALU运算的操作数和结果
13. 给定任何一个基数或者根为N的正整数，在系统中有N个各不相同的符号可以用来书写这个数字，这些符号的值的范围是0～N-1。如二进制的符号为0-1
14. 每条指令的平均周期数：average cycles per instruction，CPI
15. 动态随机存取存储器：Dynamic Random Access Memory,DRAM
16. 只读存储器：Read Only Memory，ROM